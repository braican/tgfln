function replaceText(a){if(ending){if(a=="endingGood"||a=="endingBad"){console.log("the true ending");console.log(obj[a]);fadeToBlack(obj[a])}else{setAll(obj[a].length,a)}}else{if(a=="end"){if(envNum==2){ending=true;gotoEnding()}else{envNum++;var b=env[envNum];var c="../dialogues/"+storyline+"_"+b+".txt";$.getJSON(c,function(a){obj=a;fadeBG()})}}else if(a=="booted"){$("#action").html("<h1>You got beaten up</h1>")}else{setAll(obj[a].length,a)}}}function setAll(a,b){if(a==12){var c=obj[b][0];var d=obj[b][1];var e=obj[b][2];var f=obj[b][6];var g=obj[b][7];var h=obj[b][8];$(".thought1").attr("title",f);$(".thought1").html(c);$(".thought2").attr("title",g);$(".thought2").html(d);$(".thought3").attr("title",h);$(".thought3").html(e);$(".thought3").css("visibility","visible")}else{$(".thought3").css("visibility","hidden");var c=obj[b][0];var d=obj[b][1];var f=obj[b][4];var g=obj[b][5];$(".thought1").attr("title",f);$(".thought1").html(c);$(".thought2").attr("title",g);$(".thought2").html(d)}fadeOptions(b)}function fadeToBlack(a){var b=$(document).height();$("body").append("<div id='overlay'><h1 id='outcome'>"+a+"</h1><h2 id='playAgain' onclick='playAgain()'>play again</h2></div>");$("#overlay").height(b).css({opacity:1,position:"absolute",top:0,left:0,"background-color":"black",width:"100%","z-index":100}).hide().fadeIn()}function playAgain(){console.log("play again motherfucker");$("#action").hide();$("html").css("background-image","url(../assets/apartment_poster.jpg)");$("#overlay").fadeOut();$("#opening").fadeIn();$("audio").remove()}function fadeOptions(a){$("#action").attr("title",a);if($("#action").css("display")=="none"){$("#action").fadeIn()}$("blockquote").fadeIn();$("audio").remove()}function gotoEnding(){$("#score").css("display","none");var a;if(score<5){result="bad";a="../dialogues/"+storyline+"_"+result+".txt"}else if(score>7){result="good";a="../dialogues/"+storyline+"_"+result+".txt"}else{result="special";a="../dialogues/"+storyline+"_"+result+".txt"}$.getJSON(a,function(a){obj=a;fadeBG()})}function playAudio(a,b,c){var d;if(obj[c].length==12){if(b=="thought1"){d=obj[c][3];score=score+obj[c][9]}else if(b=="thought2"){d=obj[c][4];score=score+obj[c][10]}else if(b=="thought3"){d=obj[c][5];score=score+obj[c][11]}else{d="error"}}else{if(b=="thought1"){d=obj[c][2];score=score+obj[c][6]}else if(b=="thought2"){d=obj[c][3];score=score+obj[c][7]}else{d="error"}}$("#score span").html(score);var e;if(ending){e="../audio/"+storyline+"/"+result+"/"+d+".mp3"}else{e="../audio/"+storyline+"/"+d+".mp3"}$("<audio></audio>").attr({src:e,autoplay:"autoplay"}).bind("ended",function(){replaceText(a)}).appendTo("body")}function openingAudio(){$("audio").remove();if(ending){$("#score").css("display","none")}else{$("#score").css("display","block")}$("#score span").html(score);var a;if(ending){a="../audio/"+storyline+"/"+result+"/intro.mp3"}else{a="../audio/"+storyline+"/"+storyline+env[envNum]+"intro.mp3"}$("<audio></audio>").attr({src:a,autoplay:"autoplay"}).bind("ended",function(){replaceText("begin")}).appendTo("body")}function fadeBG(){var a="url(../assets/"+env[envNum]+"_final.jpg)";$("html").fadeTo("slow",0,function(){$(this).css("background-image",a)}).fadeTo("slow",1,function(){openingAudio()})}var obj,storyline,env,envNum,score,result,ending;$(document).ready(function(){$("#action").hide();$("#opening img").click(function(){storyline=$(this).attr("title")+"";envNum=0;score=0;ending=false;if(storyline=="nerd"){env=new Array("bar","frathouse","quad")}else if(storyline=="frat"){env=new Array("frathouse","quad","bar")}else if(storyline=="hippie"){env=new Array("quad","bar","frathouse")}$.getJSON("../dialogues/"+storyline+"_"+env[0]+".txt",function(a){obj=a});var a="assets/"+storyline+"Head.png";$(".action-head").attr("src",a);$("#opening").fadeOut(function(){fadeBG()})});$("blockquote").click(function(){var a=$(this).attr("title")+"";var b=$(this).attr("class")+"";var c=$("#action").attr("title")+"";$(".thought1").fadeOut(function(){playAudio(a,b,c)});$(".thought2").fadeOut();$(".thought3").fadeOut()})})